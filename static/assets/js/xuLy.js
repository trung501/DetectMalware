var host = this.origin;
document.querySelector("#btnGetFeature").onclick = function (event) {
  event.preventDefault();
  console.log("Uploading Get Feature");
  document.querySelector("#btnGetFeature").innerHTML = "Uploading...";
  var input = document.querySelector("#inputFileGetFeature");
  var data = new FormData();
  data.append("file", input.files[0]);
  html = ``;
  fetch("/createFeature", {
    method: "POST",
    body: data,
  })
    .then(function (response) {
      return response.json();
    })
    .then(function (data) {
      if (data.hasOwnProperty("0")) {
        data = data[0];
        var index = 0;
        html += `<div class="col-2">
            <ul>`;
        for (var key in data) {
          html += `<li>${key}: ${data[key]}</li>`;
          index++;
          if (index == 30) {
            html += `</ul>
            </div>
            <div class="col-2">
             <ul>`;
          }
          console.log(key, data[key]);
        }
        html += `</ul>
        </div>`;
        console.log(html);
        document.querySelector("#FeatureAttraction").innerHTML = html;
      } else {
        alert(`Có lỗi xảy ra, hãy chắc chắn bạn đã upload một file PE`);
      }
      document.querySelector("#btnGetFeature").innerHTML = "Get Feature";
    });
};
document.querySelector("#btnCheckDetect").onclick = function (event) {
  event.preventDefault();
  console.log("Uploading check detect");
  document.querySelector("#btnCheckDetect").innerHTML = "Uploading...";
  var input = document.querySelector("#inputFileCheckDetect");
  var data = new FormData();
  data.append("file", input.files[0]);
  html = ``;
  fetch("/detectMalware", {
    method: "POST",
    body: data,
  })
    .then(function (response) {
      return response.json();
    })
    .then(function (data) {
      console.log(data);
      if (data.hasOwnProperty("Percentage")) {
        if (data["Malware"] == true) {
          html = `<h3><strong style="color: red;">Mã độc</strong> </h3><br>`;
          html += `<h3>Khả năng là mã độc :<strong> ${data["Percentage"]}%</strong></h3>`;
        } else {
          html = `<h3><strong>Không phát hiện bất thường</strong> </h3><br>`;
          html += `<h3>Khả năng là mã độc :<strong> ${data["Percentage"]}%</strong></h3>`;
        }
        document.querySelector("#resultCheckDetect").innerHTML = html;
      } else {
        alert(`Có lỗi xảy ra, hãy chắc chắn bạn đã upload một file PE`);
      }
      //   if (data.hasOwnProperty("0")) {
      //     // data = data[0];
      //     // var index = 0;
      //     // html += `<div class="col-2">
      //     //       <ul>`;
      //     // for (var key in data) {
      //     //   html += `<li>${key}: ${data[key]}</li>`;
      //     //   index++;
      //     //   if (index == 30) {
      //     //     html += `</ul>
      //     //       </div>
      //     //       <div class="col-2">
      //     //        <ul>`;
      //     //   }
      //     //   console.log(key, data[key]);
      //     // }
      //     // html += `</ul>
      //     //   </div>`;
      //     // console.log(html);
      //     // document.querySelector("#FeatureAttraction").innerHTML = html;
      //     console.log(data);
      //   } else {
      //     alert(`Có lỗi xảy ra, hãy chắc chắn bạn đã upload một file PE`);
      //   }
      document.querySelector("#btnCheckDetect").innerHTML = "Check";
    });
};
